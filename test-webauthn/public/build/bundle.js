var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function o(t){t.forEach(e)}function r(t){return"function"==typeof t}function a(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function i(t,e){t.appendChild(e)}function l(t,e,n){t.insertBefore(e,n||null)}function c(t){t.parentNode.removeChild(t)}function u(t){return document.createElement(t)}function s(t){return document.createTextNode(t)}function f(){return s(" ")}function d(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function p(t){return function(e){return e.preventDefault(),t.call(this,e)}}function m(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function h(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function g(t,e){t.value=null==e?"":e}let $;function y(t){$=t}const b=[],w=[],v=[],A=[],x=Promise.resolve();let S=!1;function _(t){v.push(t)}function E(t){A.push(t)}let O=!1;const C=new Set;function T(){if(!O){O=!0;do{for(let t=0;t<b.length;t+=1){const e=b[t];y(e),j(e.$$)}for(y(null),b.length=0;w.length;)w.pop()();for(let t=0;t<v.length;t+=1){const e=v[t];C.has(e)||(C.add(e),e())}v.length=0}while(b.length);for(;A.length;)A.pop()();S=!1,O=!1,C.clear()}}function j(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(_)}}const U=new Set;function N(t,e){t&&t.i&&(U.delete(t),t.i(e))}function D(t,e,n,o){if(t&&t.o){if(U.has(t))return;U.add(t),undefined.c.push((()=>{U.delete(t),o&&(n&&t.d(1),o())})),t.o(e)}}function k(t,e,n){const o=t.$$.props[e];void 0!==o&&(t.$$.bound[o]=n,n(t.$$.ctx[o]))}function B(t){t&&t.c()}function J(t,n,a,i){const{fragment:l,on_mount:c,on_destroy:u,after_update:s}=t.$$;l&&l.m(n,a),i||_((()=>{const n=c.map(e).filter(r);u?u.push(...n):o(n),t.$$.on_mount=[]})),s.forEach(_)}function K(t,e){const n=t.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function P(t,e){-1===t.$$.dirty[0]&&(b.push(t),S||(S=!0,x.then(T)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function z(e,r,a,i,l,u,s=[-1]){const f=$;y(e);const d=e.$$={fragment:null,ctx:null,props:u,update:t,not_equal:l,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(f?f.$$.context:[]),callbacks:n(),dirty:s,skip_bound:!1};let p=!1;if(d.ctx=a?a(e,r.props||{},((t,n,...o)=>{const r=o.length?o[0]:n;return d.ctx&&l(d.ctx[t],d.ctx[t]=r)&&(!d.skip_bound&&d.bound[t]&&d.bound[t](r),p&&P(e,t)),n})):[],d.update(),p=!0,o(d.before_update),d.fragment=!!i&&i(d.ctx),r.target){if(r.hydrate){const t=function(t){return Array.from(t.childNodes)}(r.target);d.fragment&&d.fragment.l(t),t.forEach(c)}else d.fragment&&d.fragment.c();r.intro&&N(e.$$.fragment),J(e,r.target,r.anchor,r.customElement),T()}y(f)}class I{$destroy(){K(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const Z="function"==typeof atob,H="function"==typeof btoa,L="function"==typeof Buffer,q=("function"==typeof TextDecoder&&new TextDecoder,"function"==typeof TextEncoder&&new TextEncoder,[..."ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="]),M=(t=>{let e={};return t.forEach(((t,n)=>e[t]=n)),e})(q),R=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,W=String.fromCharCode.bind(String),F="function"==typeof Uint8Array.from?Uint8Array.from.bind(Uint8Array):(t,e=(t=>t))=>new Uint8Array(Array.prototype.slice.call(t,0).map(e)),G=t=>t.replace(/[+\/]/g,(t=>"+"==t?"-":"_")).replace(/=+$/m,""),Q=t=>t.replace(/[^A-Za-z0-9\+\/]/g,""),V=t=>{let e,n,o,r,a="";const i=t.length%3;for(let i=0;i<t.length;){if((n=t.charCodeAt(i++))>255||(o=t.charCodeAt(i++))>255||(r=t.charCodeAt(i++))>255)throw new TypeError("invalid character found");e=n<<16|o<<8|r,a+=q[e>>18&63]+q[e>>12&63]+q[e>>6&63]+q[63&e]}return i?a.slice(0,i-3)+"===".substring(i):a},X=H?t=>btoa(t):L?t=>Buffer.from(t,"binary").toString("base64"):V,Y=L?t=>Buffer.from(t).toString("base64"):t=>{let e=[];for(let n=0,o=t.length;n<o;n+=4096)e.push(W.apply(null,t.subarray(n,n+4096)));return X(e.join(""))},tt=(t,e=!1)=>e?G(Y(t)):Y(t),et=t=>{if(t=t.replace(/\s+/g,""),!R.test(t))throw new TypeError("malformed base64.");t+="==".slice(2-(3&t.length));let e,n,o,r="";for(let a=0;a<t.length;)e=M[t.charAt(a++)]<<18|M[t.charAt(a++)]<<12|(n=M[t.charAt(a++)])<<6|(o=M[t.charAt(a++)]),r+=64===n?W(e>>16&255):64===o?W(e>>16&255,e>>8&255):W(e>>16&255,e>>8&255,255&e);return r},nt=Z?t=>atob(Q(t)):L?t=>Buffer.from(t,"base64").toString("binary"):et,ot=L?t=>F(Buffer.from(t,"base64")):t=>F(nt(t),(t=>t.charCodeAt(0))),rt=t=>ot(at(t)),at=t=>Q(t.replace(/[-_]/g,(t=>"-"==t?"+":"/"))),it=tt,lt=rt;function ct(e){let n,o,r,a,p,$;return{c(){n=u("label"),o=s(e[2]),r=f(),a=u("input"),m(n,"for",e[4]),m(n,"class","svelte-19vplbx"),m(a,"placeholder",e[1]),m(a,"id",e[4]),m(a,"name",e[3]),m(a,"type","text")},m(t,c){l(t,n,c),i(n,o),l(t,r,c),l(t,a,c),g(a,e[0]),p||($=d(a,"input",e[5]),p=!0)},p(t,[e]){4&e&&h(o,t[2]),16&e&&m(n,"for",t[4]),2&e&&m(a,"placeholder",t[1]),16&e&&m(a,"id",t[4]),8&e&&m(a,"name",t[3]),1&e&&a.value!==t[0]&&g(a,t[0])},i:t,o:t,d(t){t&&c(n),t&&c(r),t&&c(a),p=!1,$()}}}function ut(t,e,n){let{value:o}=e,{placeholder:r}=e,{label:a}=e,{name:i}=e,{id:l}=e;return t.$$set=t=>{"value"in t&&n(0,o=t.value),"placeholder"in t&&n(1,r=t.placeholder),"label"in t&&n(2,a=t.label),"name"in t&&n(3,i=t.name),"id"in t&&n(4,l=t.id)},[o,r,a,i,l,function(){o=this.value,n(0,o)}]}class st extends I{constructor(t){super(),z(this,t,ut,ct,a,{value:0,placeholder:1,label:2,name:3,id:4})}}function ft(t){let e,n,o,r,a,s,h,g,$;function y(e){t[4](e)}let b={name:"name",label:"Name",id:"name",placeholder:"Enter name..."};return void 0!==t[0]&&(b.value=t[0]),o=new st({props:b}),w.push((()=>k(o,"value",y))),{c(){e=u("main"),n=u("form"),B(o.$$.fragment),a=f(),s=u("button"),s.textContent="Login",m(s,"type","submit")},m(r,c){l(r,e,c),i(e,n),J(o,n,null),i(n,a),i(n,s),h=!0,g||($=d(n,"submit",p(t[5])),g=!0)},p(t,[e]){const n={};!r&&1&e&&(r=!0,n.value=t[0],E((()=>r=!1))),o.$set(n)},i(t){h||(N(o.$$.fragment,t),h=!0)},o(t){D(o.$$.fragment,t),h=!1},d(t){t&&c(e),K(o),g=!1,$()}}}function dt(t,e,n){let{onSubmit:o}=e,{fields:r}=e,a="";const i=async t=>{const e=await fetch(`/auth/challenge/login/${a}`,{method:"POST"}),n=await e.json();let{challenge:o,allowCredentials:r}=n.publicKey;o=lt(o);let i=r.map((t=>{let{id:e,type:n}=t;return e=lt(e),{type:n,id:e}}));const l=await navigator.credentials.get({publicKey:{...n.publicKey,challenge:o,allowCredentials:i}});console.log("success",l),await(async t=>{let{rawId:e,response:n,id:o,type:r}=t;e=it(new Uint8Array(e),!0),console.log(e);let{authenticatorData:i,clientDataJSON:l,signature:c,userHandle:u}=n;i=it(new Uint8Array(i),!0),l=it(new Uint8Array(l),!0),c=it(new Uint8Array(c),!0),u=it(new Uint8Array(u),!0),n={authenticatorData:i,clientDataJSON:l,signature:c,userHandle:u};const s=await fetch(`/auth/login/${a}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:o,rawId:e,response:n,type:r})}),f=await s.json();console.log(f)})(l)};return t.$$set=t=>{"onSubmit"in t&&n(2,o=t.onSubmit),"fields"in t&&n(3,r=t.fields)},[a,i,o,r,function(t){a=t,n(0,a)},t=>i()]}class pt extends I{constructor(t){super(),z(this,t,dt,ft,a,{onSubmit:2,fields:3})}}function mt(t){let e,n,o,r,a,s,h,g,$;function y(e){t[4](e)}let b={name:"name",label:"Name",id:"name",placeholder:"Enter name..."};return void 0!==t[0]&&(b.value=t[0]),o=new st({props:b}),w.push((()=>k(o,"value",y))),{c(){e=u("main"),n=u("form"),B(o.$$.fragment),a=f(),s=u("button"),s.textContent="Register",m(s,"type","submit")},m(r,c){l(r,e,c),i(e,n),J(o,n,null),i(n,a),i(n,s),h=!0,g||($=d(n,"submit",p(t[5])),g=!0)},p(t,[e]){const n={};!r&&1&e&&(r=!0,n.value=t[0],E((()=>r=!1))),o.$set(n)},i(t){h||(N(o.$$.fragment,t),h=!0)},o(t){D(o.$$.fragment,t),h=!1},d(t){t&&c(e),K(o),g=!1,$()}}}function ht(t,e,n){let{onSubmit:o}=e,{fields:r}=e,a="";const i=async t=>{const e=await fetch(`/auth/challenge/register/${a}`,{method:"POST"}),n=await e.json();console.log(n);let{challenge:o,user:r}=n.publicKey;o=lt(o),r.id=lt(r.id,!0);const i=await navigator.credentials.create({publicKey:{...n.publicKey,challenge:o,user:r}});console.log("success",i),await(async t=>{let{rawId:e,response:n,id:o,type:r}=t;e=it(new Uint8Array(e),!0),console.log(e);let{attestationObject:i,clientDataJSON:l}=n;i=it(new Uint8Array(i),!0),l=it(new Uint8Array(l),!0),console.log(i,l),n={attestationObject:i,clientDataJSON:l};const c=await fetch(`/auth/register/${a}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:o,rawId:e,response:n,type:r})}),u=await c.json();console.log(u)})(i)};return t.$$set=t=>{"onSubmit"in t&&n(2,o=t.onSubmit),"fields"in t&&n(3,r=t.fields)},[a,i,o,r,function(t){a=t,n(0,a)},t=>i()]}class gt extends I{constructor(t){super(),z(this,t,ht,mt,a,{onSubmit:2,fields:3})}}function $t(t){let e,n,o,r,a,d,p,g,$,y;return p=new gt({}),$=new pt({}),{c(){e=u("main"),n=u("h1"),o=s("Hello "),r=s(t[0]),a=s("!"),d=f(),B(p.$$.fragment),g=f(),B($.$$.fragment),m(n,"class","svelte-1e9puaw"),m(e,"class","svelte-1e9puaw")},m(t,c){l(t,e,c),i(e,n),i(n,o),i(n,r),i(n,a),i(e,d),J(p,e,null),i(e,g),J($,e,null),y=!0},p(t,[e]){(!y||1&e)&&h(r,t[0])},i(t){y||(N(p.$$.fragment,t),N($.$$.fragment,t),y=!0)},o(t){D(p.$$.fragment,t),D($.$$.fragment,t),y=!1},d(t){t&&c(e),K(p),K($)}}}function yt(t,e,n){let{name:o}=e;return o="Web authentication",t.$$set=t=>{"name"in t&&n(0,o=t.name)},[o]}return new class extends I{constructor(t){super(),z(this,t,yt,$t,a,{name:0})}}({target:document.body,props:{name:"world"}})}();
//# sourceMappingURL=bundle.js.map
